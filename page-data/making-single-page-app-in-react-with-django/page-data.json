{"componentChunkName":"component---src-templates-page-js","path":"/making-single-page-app-in-react-with-django","result":{"data":{"markdownRemark":{"frontmatter":{"title":"Making Single-Page App in React with Django","date":"01 February 2020","path":"/making-single-page-app-in-react-with-django","author":"James","excerpt":"Creating a single page app in React is getting easier than the past. There are many readings on blogs, Stackoverflow and Github talking about making a SPA  using React, and it should be sufficient in many cases.","tags":["react","javascript","python","django","programming"],"coverImage":null},"id":"1047fd4b-2fde-5302-886a-83a93b00ea02","html":"<p>Creating a single page app in React is getting easier than the past. There are many readings on blogs, Stackoverflow and Github talking about making a SPA\nusing React, and it should be sufficient in many cases. A few days ago, I have encountered a problem: How do I use Django and React together?\nThis reading is for a reference for myself and those who are interested in deploying a SPA in React with Django and implementing JWT authentication together.</p>\n<br />\n<br />\n<h2>Versions</h2>\n<p>Django: 3.0.2\npython: 3.8.1\nreact: 16.12\nreact-router-dom: 5.1.2\nI am using macOS Catalina (10.15.1) for this reading.</p>\n<br />\n<br />\n<h2>Prerequisites</h2>\n<h3>pyenv &#x26; Python</h3>\n<p>We are going to create a Django project and virtual environment first. Visit <a href=\"https://github.com/pyenv/pyenv-virtualenv\">pyenv repo</a> and install pyenv-virtualenv.\nAfter installing pyenv, install python for pyenv with:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">pyenv install 3.8.1</code></pre></div>\n<br />\n<h3>pip</h3>\n<p>To install pip, run:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo apt-get pip\npip install --upgrade pip</code></pre></div>\n<br />\n<br />\n<hr>\n<h2>Making A Virtual Environment</h2>\n<p>Let's begin. To save a project locally, create an empty directory and move:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">mkdir projectEnv\ncd projectEnv</code></pre></div>\n<br />\n<p>Once we are in <code class=\"language-text\">projectEnv</code> directory, make a virtual environment to avoid a dependency issue. Run the following command to create a virtual environment that uses Python 3.8.1 version. I used the same name of the directory:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">pyenv virtualenv 3.8.1 projectEnv</code></pre></div>\n<br />\n<p>After, we need to set the <code class=\"language-text\">projectEnv</code> directory to use the virtual environment, and confirm the python version of the environment:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">pyenv local projectEnv\npython --version // Python 3.8.1</code></pre></div>\n<br />\n<p>If everything is okay, you will find that command line looks slightly different like the below:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">(projectEnv) james@James projectEnv</code></pre></div>\n<br />\n<br />\n<hr>\n<h2>Django Init</h2>\n<p>There are multiple ways to install Django. In order to get the latest official version, install it using pip:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">pip install Django==3.0.2</code></pre></div>\n<br />\n<p>Vertify the version by the following command:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">python -m django --version // 3.0.2</code></pre></div>\n<br />\n<p>Run the following command to 1) create a Django project <code class=\"language-text\">myProject</code> and 2) go to inside of the project:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">django-admin startproject myProject\ncd myProject</code></pre></div>\n<br />\n<p>In order to check whether it is running well or not, there is no better way other than trying it out.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">python manage.py runserver</code></pre></div>\n<br />\nThe above command will show you the beautiful a Django default landing page!\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/aede0e55131fbbd39846d710221d4b81/f9c26/django-default-landing-page.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAAA+UlEQVQoz41Ti3KEIAy8//+3fkRnOtPKXUVQEHltE+7OVg+0GTOEJSxLgpecM9h6qzHMU4kZaznoc37B6CystYgxrnvYLs9g3XBG+FhPOZFvsUL4d/KfOOMXq+UdKmQLKUH5+VD5i8LWaWyG6vUm3l9y9nmrwhpZIlXOOUyTwaA0tB4hpYIxtuB7VaeEPBpjIIQo3nUCH90nvq5dITxSeXhlVsrPwnv/6GpqlqbZlH2xaweeNqW1+axhtVpuFPoY7p7i/fHSlTleCIs0EojAJSjzVCVdCUMIuOkBV9Xjm0bG58XhpiTE0GMOC3LKkKOCoBw56c1v9+T5AcKNtZUSPDpKAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Django default landing page\"\n        title=\"Django default landing page\"\n        src=\"/static/aede0e55131fbbd39846d710221d4b81/78d47/django-default-landing-page.png\"\n        srcset=\"/static/aede0e55131fbbd39846d710221d4b81/56d15/django-default-landing-page.png 200w,\n/static/aede0e55131fbbd39846d710221d4b81/d9f49/django-default-landing-page.png 400w,\n/static/aede0e55131fbbd39846d710221d4b81/78d47/django-default-landing-page.png 800w,\n/static/aede0e55131fbbd39846d710221d4b81/64756/django-default-landing-page.png 1200w,\n/static/aede0e55131fbbd39846d710221d4b81/42cbc/django-default-landing-page.png 1600w,\n/static/aede0e55131fbbd39846d710221d4b81/f9c26/django-default-landing-page.png 2880w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<br />\n<br />\n<hr>\n<h2>Create-react-app</h2>\n<p>There are a few ways to install and deploy React app, but I personally prefer an easier way always.</p>\n<p>Create a python app using the following command:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">python manage.py startapp frontend</code></pre></div>\n<br />\n<p>To set up a react app, execute the following:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npx create-react-app frontend-react</code></pre></div>\n<br />\n<p>You would be able to find a <code class=\"language-text\">frontend</code> and <code class=\"language-text\">frontend-react</code> directories inside of <code class=\"language-text\">myProject</code> directory.</p>\n<p>Let's move to <code class=\"language-text\">frontend-react</code> and see if it is working.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">yarn start // OR the below is possible too\nnpm start</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8f340fe3b6aa9f44ce3bb7367a8aa244/f621c/react-default-landing-page.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.49999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA1ElEQVQoz2PQ0DH5jwuraxsTJYaMGQgZBqKRMSFDGYh1HYRvimIw0QbCNKhpGPzXMrH7b5VS8t8iLu+/jqUzUEwfbjDpLtQ1/W8Wmf7frWPuf9e22f/No7P+q2sZkheGYEO1jP4b+8eADXRpnPrfNDT5v7omiQbCAx7qZQ198/9GftH/DX2j/msYWP5XBYnhiXGcYailZ/bf1NIBjI0Mzf8bm1jB+Zq6JIYhTDFIoxbQhfp2nkDsAWaDxPAlHQZi0h8ocjR0zYhKjwyE0yCyIcYEcwwAkxRXtxsPvWEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"React default landing page\"\n        title=\"React default landing page\"\n        src=\"/static/8f340fe3b6aa9f44ce3bb7367a8aa244/78d47/react-default-landing-page.png\"\n        srcset=\"/static/8f340fe3b6aa9f44ce3bb7367a8aa244/56d15/react-default-landing-page.png 200w,\n/static/8f340fe3b6aa9f44ce3bb7367a8aa244/d9f49/react-default-landing-page.png 400w,\n/static/8f340fe3b6aa9f44ce3bb7367a8aa244/78d47/react-default-landing-page.png 800w,\n/static/8f340fe3b6aa9f44ce3bb7367a8aa244/64756/react-default-landing-page.png 1200w,\n/static/8f340fe3b6aa9f44ce3bb7367a8aa244/42cbc/react-default-landing-page.png 1600w,\n/static/8f340fe3b6aa9f44ce3bb7367a8aa244/f621c/react-default-landing-page.png 2878w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<br />\n<br />\n<hr>\n<h2>Django Rest &#x26; JWT</h2>\n<p>Before we proceed to further, let's move react files into Django app just in case. Copy evert file in <code class=\"language-text\">frontend-react</code> and paste them in <code class=\"language-text\">frontend</code> folder. (<code class=\"language-text\">frontend-react</code> folder can be deleted once files are pasted)</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c07fbb1d3556602fd2f985e60136079e/ea3e4/django-react-files.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.49999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABNElEQVQoz62ST2+CQBDF9/t/kl577rWntrEXo2XRCkhaoxZkWdh/Lq87WA0xqdHETX6Z4e0wszyWlWWJuq5RVRWEEJBSQrUtrFZomqbXKLZBG0Ia1Q4jwYwxsNZCax2iQ2cN4srhZWPhnYV1rt93IVKt9/4ip4ZKqcNL4WSVsthIHYaovgkNoz2q6bruxHAdNYY7L0bfrZTupxN0mrZVB58C9Z8/5x4Sx3rimLP30RuSxSdi/gHOoxADcYR5zDGJOMbjMXg0DVp8gnOO2WyGNE2xXC77mOc5siwDe4x2eM4EtpsdFmuBh/C8LiXKQuApERitJIqQ1w3557Hf7y/CXhOF6bfBJNf4Ki3mW4O8sIhXBith8SNdyDWk9td5eIvhwz/8H8xfUTS8JufXZaj1Dbs7N/wFf9pXH/L3kSkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Copying files in frontend-react and pasting them in frontend directory\"\n        title=\"Copying files in frontend-react and pasting them in frontend directory\"\n        src=\"/static/c07fbb1d3556602fd2f985e60136079e/78d47/django-react-files.png\"\n        srcset=\"/static/c07fbb1d3556602fd2f985e60136079e/56d15/django-react-files.png 200w,\n/static/c07fbb1d3556602fd2f985e60136079e/d9f49/django-react-files.png 400w,\n/static/c07fbb1d3556602fd2f985e60136079e/78d47/django-react-files.png 800w,\n/static/c07fbb1d3556602fd2f985e60136079e/64756/django-react-files.png 1200w,\n/static/c07fbb1d3556602fd2f985e60136079e/42cbc/django-react-files.png 1600w,\n/static/c07fbb1d3556602fd2f985e60136079e/ea3e4/django-react-files.png 2514w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<br />\n<p>In the terminal, run the following command to move to frontend (I assume that we are in frontend-react folder)</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">cd ... // move to projectEnv/myProject\ncd myProject </code></pre></div>\n<br />\n<p>To achieve our goal (i.e, react SPA with Django and Auth), we need to install Django, Django REST framework, Django REST framework JWT and Django CORS headers. </p>\n<p>(MORE EXPLANATION WILL BE UPDATED)</p>\n<p>Type the following to install the mentioned package:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">// Assumption: we are in projectEnv/myProject\n\npip install django // Might be installed already\npip install djangorestframework\npip install djangorestframework-jwt\npip install django-cors-headers</code></pre></div>\n<br />\n<p>Now, we need to update our <code class=\"language-text\">settings.py</code>. In the file, add the followings:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">INSTALLED_APPS = [\n    ...\n    &#39;rest_framework&#39;,\n    &#39;corsheaders&#39;\n]\n\n    \n\nMIDDLEWARE = [\n    ...\n    &#39;corsheaders.middleware.CorsMiddleware&#39;,\n    &#39;django.middleware.common.CommonMiddleware&#39;, \n    // This should be included already. Here for reference\n    ...\n]\n\n    \n\nREST_FRAMEWORK = {\n     &#39;DEFAULT_PERMISSION_CLASSES&#39;: (\n            &#39;rest_framework.permissions.IsAuthenticated&#39;,\n    ),\n    &#39;DEFAULT_AUTHENTICATION_CLASSES&#39;: (\n        &#39;rest_framework_jwt.authentication.JSONWebTokenAuthentication&#39;,\n        &#39;rest_framework.authentication.SessionAuthentication&#39;,\n        &#39;rest_framework.authentication.BasicAuthentication&#39;,\n    ),\n}\n\n    CORS_ORIGIN_WHITELIST = [\n    &#39;http://localhost:3000&#39;,\n    &#39;http://localhost:8000&#39;,\n    &#39;http://localhost:8080&#39;\n    ]</code></pre></div>\n<p>NOTE: </p>\n<ul>\n<li>In <code class=\"language-text\">MIDDLEWARE</code>, the order must be kept. </li>\n<li><code class=\"language-text\">DEFAULT_PERMISSION_CLASSES</code> enforces a request to be authenticated before processed. </li>\n<li><code class=\"language-text\">DEFAULT_AUTHENTICATION_CLASSES</code> defines which authentication class the server will use once received a request.</li>\n<li><code class=\"language-text\">CORS_ORIGIN_WHITELIST</code> is needed so that React app can communicate with the server.</li>\n</ul>\n<br />\n<p>To see how jwt token works, we will also configure <code class=\"language-text\">urls.py</code></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">from rest_framework_jwt.views import obtain_jwt_token\nurlpatterns = [\n    ...\n    path(&#39;token/&#39;, obtain_jwt_token)\n]</code></pre></div>\n<br />\nWe are almost ready. Update the app by migrating, and create a super user:\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Assumption: we are in projectEnv/myProject\npython manage.py migrate\npython manage.py createsuperuser</code></pre></div>\n<br />\n<p>Once you type the last line, you will be asked to enter username, email address and password for the username. That's it!</p>\n<p>Now, let's test how it looks. Run the following command,</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">python manage.py runserver</code></pre></div>\n<p>and visit <a href=\"http://localhost:8000/token/\">http://localhost:8000/token/</a>, typing username and password.</p>\n<!-- \n![Before entering username and password to obtain a token](../images/2020-02-01/before-token.png)\n\n![After entering username and password to obtain a token](../images/2020-02-01/after-token.png) -->","excerpt":"Creating a single page app in React is getting easier than the past. There are many readings on blogs, Stackoverflow and Github talking…"}},"pageContext":{"type":"posts","next":null,"previous":{"frontmatter":{"path":"/deploying-react-spa-in-10-minutes-using-azure","title":"Deploying React SPA in 10 Minutes using Azure","tags":["azure","react","cloud","programming"]},"fileAbsolutePath":"/Users/james/Development/Git/jyoo/src/posts/2020-03-11-deploying-react-spa-in-10-mins-using-azure.md"}}}}